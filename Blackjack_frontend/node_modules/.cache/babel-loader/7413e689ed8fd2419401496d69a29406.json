{"ast":null,"code":"import Web3 from \"web3\";\nimport BlackJackContractBuild from \"contracts/BlackJackV2.json\"; //let BlackJackContract;\n\nlet isInitial = false;\nlet BlackJackContract;\nlet accounts;\nlet currentP; //balance\n\nlet dealer;\nlet dealerBal;\nlet player;\nlet playerBal;\nlet contractBal; //const PROVIDER_URL='http://localhost:3000'\n\nexport const initializeContract = async () => {\n  if (!isInitial) {\n    let provider = window.ethereum;\n    const web3 = new Web3(provider);\n    const networkID = await web3.eth.net.getId();\n    const contractAddress = BlackJackContractBuild.networks[networkID].address;\n    BlackJackContract = new web3.eth.Contract(BlackJackContractBuild.abi, contractAddress);\n    accounts = await web3.eth.getAccounts();\n    isInitial = true; //should be removed in production.\n\n    currentP = accounts[0];\n    player = await BlackJackContract.methods.player().call();\n    playerBal = await BlackJackContract.methods.playerBalance().call();\n    dealer = await BlackJackContract.methods.dealer().call();\n    dealerBal = await BlackJackContract.methods.dealerBalance().call();\n    contractBal;\n  }\n\n  console.log(`current player:${currentP}`);\n  console.log(`player (should be same as current p):${player}`);\n  console.log(`player bal:${playerBal}`);\n  console.log(`current dealer:${dealer}`);\n  console.log(`dealer bal:${dealerBal}`); //dealerBal= await BlackJackContract.methods.dealerBalance().call()\n  //const maxb=await BlackJackContract.methods.maxBet().call()\n  //const join=await BlackJackContract.methods.joinGame().send({from:accounts[0],value:10})\n  //data= await web3.eth.getCode(contractAddress)\n  //const deploy= await  BlackJackContract.deploy({data:data,arguments: [10, 1000]})\n  //console.log(dealerBal)\n  //console.log(maxb)\n  //const dealer= await BlackJackContract.methods.dealer().call()\n  //const balance=await web3.eth.getBalance(contractAddress)\n};\nexport const joinGame = async () => {\n  if (!isInitial) {\n    await initializeContract();\n  }\n\n  return BlackJackContract.methods.joinGame().send({\n    from: accounts[0],\n    value: 10\n  });\n};\nexport const getDealer = async () => {\n  if (!isInitial) {\n    await initializeContract();\n  }\n\n  return BlackJackContract.methods.dealer().call();\n};","map":{"version":3,"names":["Web3","BlackJackContractBuild","isInitial","BlackJackContract","accounts","currentP","dealer","dealerBal","player","playerBal","contractBal","initializeContract","provider","window","ethereum","web3","networkID","eth","net","getId","contractAddress","networks","address","Contract","abi","getAccounts","methods","call","playerBalance","dealerBalance","console","log","joinGame","send","from","value","getDealer"],"sources":["/Users/tedwu/Desktop/未命名檔案夾 4/Blackjack/Blackjack_frontend/src/Web3Client.js"],"sourcesContent":["import Web3 from \"web3\"\nimport BlackJackContractBuild from \"contracts/BlackJackV2.json\"\n\n//let BlackJackContract;\nlet isInitial=false;\n\nlet BlackJackContract;\nlet accounts;\nlet currentP\n//balance\nlet dealer;\nlet dealerBal;\nlet player;\nlet playerBal;\nlet contractBal;\n\n//const PROVIDER_URL='http://localhost:3000'\n\nexport const initializeContract= async ()=>{\n\nif(!isInitial){\nlet provider = window.ethereum \nconst web3 =new Web3(provider)\nconst networkID= await web3.eth.net.getId()\nconst contractAddress=BlackJackContractBuild.networks[networkID].address \nBlackJackContract= new web3.eth.Contract(BlackJackContractBuild.abi,contractAddress)\n\naccounts = await web3.eth.getAccounts();\nisInitial=true\n\n//should be removed in production.\ncurrentP=accounts[0]\nplayer= await BlackJackContract.methods.player().call()\nplayerBal= await BlackJackContract.methods.playerBalance().call()\ndealer= await BlackJackContract.methods.dealer().call()\ndealerBal=await BlackJackContract.methods.dealerBalance().call()\ncontractBal\n\n}\nconsole.log(`current player:${currentP}`)\nconsole.log(`player (should be same as current p):${player}`)\nconsole.log(`player bal:${playerBal}`)\nconsole.log(`current dealer:${dealer}`)\nconsole.log(`dealer bal:${dealerBal}`)\n\n//dealerBal= await BlackJackContract.methods.dealerBalance().call()\n//const maxb=await BlackJackContract.methods.maxBet().call()\n//const join=await BlackJackContract.methods.joinGame().send({from:accounts[0],value:10})\n//data= await web3.eth.getCode(contractAddress)\n//const deploy= await  BlackJackContract.deploy({data:data,arguments: [10, 1000]})\n//console.log(dealerBal)\n//console.log(maxb)\n//const dealer= await BlackJackContract.methods.dealer().call()\n//const balance=await web3.eth.getBalance(contractAddress)\n\n} \n\n\n\nexport const joinGame= async ()=>{\n    if(!isInitial){\n        await initializeContract();}\n   \n        return BlackJackContract.methods.joinGame().send({from:accounts[0],value:10})\n    }\n    \n\n\n\nexport const getDealer= async ()=>{\n    if(!isInitial){\n        await initializeContract();\n    }\n        return BlackJackContract.methods.dealer().call()\n    }\n    \n\n\n\n\n\n"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,sBAAP,MAAmC,4BAAnC,C,CAEA;;AACA,IAAIC,SAAS,GAAC,KAAd;AAEA,IAAIC,iBAAJ;AACA,IAAIC,QAAJ;AACA,IAAIC,QAAJ,C,CACA;;AACA,IAAIC,MAAJ;AACA,IAAIC,SAAJ;AACA,IAAIC,MAAJ;AACA,IAAIC,SAAJ;AACA,IAAIC,WAAJ,C,CAEA;;AAEA,OAAO,MAAMC,kBAAkB,GAAE,YAAU;EAE3C,IAAG,CAACT,SAAJ,EAAc;IACd,IAAIU,QAAQ,GAAGC,MAAM,CAACC,QAAtB;IACA,MAAMC,IAAI,GAAE,IAAIf,IAAJ,CAASY,QAAT,CAAZ;IACA,MAAMI,SAAS,GAAE,MAAMD,IAAI,CAACE,GAAL,CAASC,GAAT,CAAaC,KAAb,EAAvB;IACA,MAAMC,eAAe,GAACnB,sBAAsB,CAACoB,QAAvB,CAAgCL,SAAhC,EAA2CM,OAAjE;IACAnB,iBAAiB,GAAE,IAAIY,IAAI,CAACE,GAAL,CAASM,QAAb,CAAsBtB,sBAAsB,CAACuB,GAA7C,EAAiDJ,eAAjD,CAAnB;IAEAhB,QAAQ,GAAG,MAAMW,IAAI,CAACE,GAAL,CAASQ,WAAT,EAAjB;IACAvB,SAAS,GAAC,IAAV,CARc,CAUd;;IACAG,QAAQ,GAACD,QAAQ,CAAC,CAAD,CAAjB;IACAI,MAAM,GAAE,MAAML,iBAAiB,CAACuB,OAAlB,CAA0BlB,MAA1B,GAAmCmB,IAAnC,EAAd;IACAlB,SAAS,GAAE,MAAMN,iBAAiB,CAACuB,OAAlB,CAA0BE,aAA1B,GAA0CD,IAA1C,EAAjB;IACArB,MAAM,GAAE,MAAMH,iBAAiB,CAACuB,OAAlB,CAA0BpB,MAA1B,GAAmCqB,IAAnC,EAAd;IACApB,SAAS,GAAC,MAAMJ,iBAAiB,CAACuB,OAAlB,CAA0BG,aAA1B,GAA0CF,IAA1C,EAAhB;IACAjB,WAAW;EAEV;;EACDoB,OAAO,CAACC,GAAR,CAAa,kBAAiB1B,QAAS,EAAvC;EACAyB,OAAO,CAACC,GAAR,CAAa,wCAAuCvB,MAAO,EAA3D;EACAsB,OAAO,CAACC,GAAR,CAAa,cAAatB,SAAU,EAApC;EACAqB,OAAO,CAACC,GAAR,CAAa,kBAAiBzB,MAAO,EAArC;EACAwB,OAAO,CAACC,GAAR,CAAa,cAAaxB,SAAU,EAApC,EAzB2C,CA2B3C;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AAEC,CArCM;AAyCP,OAAO,MAAMyB,QAAQ,GAAE,YAAU;EAC7B,IAAG,CAAC9B,SAAJ,EAAc;IACV,MAAMS,kBAAkB,EAAxB;EAA4B;;EAE5B,OAAOR,iBAAiB,CAACuB,OAAlB,CAA0BM,QAA1B,GAAqCC,IAArC,CAA0C;IAACC,IAAI,EAAC9B,QAAQ,CAAC,CAAD,CAAd;IAAkB+B,KAAK,EAAC;EAAxB,CAA1C,CAAP;AACH,CALE;AAUP,OAAO,MAAMC,SAAS,GAAE,YAAU;EAC9B,IAAG,CAAClC,SAAJ,EAAc;IACV,MAAMS,kBAAkB,EAAxB;EACH;;EACG,OAAOR,iBAAiB,CAACuB,OAAlB,CAA0BpB,MAA1B,GAAmCqB,IAAnC,EAAP;AACH,CALE"},"metadata":{},"sourceType":"module"}